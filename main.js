(()=>{"use strict";function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var e=function(){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),this.text=t,this.id=e.countInstances()}var n,o;return n=e,o=[{key:"countInstances",value:function(){return e.count=(e.count||0)+1,e.count}}],null&&t(n.prototype,null),o&&t(n,o),e}();function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function i(t,e){return!e||"object"!==n(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var a=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,t);var e,n,a=(e=r,n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,o=s(e);if(n){var a=s(this).constructor;t=Reflect.construct(o,arguments,a)}else t=o.apply(this,arguments);return i(this,t)});function r(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,r),(e=a.call(this,t)).favorite=!1,e}return r}(e);function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(t,e){return!e||"object"!==r(e)&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&l(t,e)}(a,t);var e,n,o,i,s=(o=a,i=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}(),function(){var t,e=d(o);if(i){var n=d(this).constructor;t=Reflect.construct(e,arguments,n)}else t=e.apply(this,arguments);return u(this,t)});function a(t){var e;return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a),(e=s.call(this,t)).taskList=[],e.active=!0,e}return e=a,(n=[{key:"appendTask",value:function(t){this.taskList.push(t)}},{key:"deleteTask",value:function(t){var e=this.getIndexOfTask(t);this.taskList.splice(e,1)}},{key:"getTask",value:function(t){var e=this.getIndexOfTask(t);return this.taskList[e]}},{key:"getIndexOfTask",value:function(t){return t=parseInt(t),this.taskList.findIndex((function(e){return e.id===t}))}},{key:"update",value:function(t){this.text=t}}])&&c(e.prototype,n),a}(e);function f(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var y=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.Context=e,this.list=[],this.init()}var e,n;return e=t,(n=[{key:"init",value:function(){var t=new h("inbox");this.addNewContext(t),this.setActiveContext(t)}},{key:"addNewContext",value:function(t){this.list.push(t)}},{key:"deleteContext",value:function(t){var e=this.getIndexOfContext(t);this.list.splice(e,1)}},{key:"getContext",value:function(t){var e=this.getIndexOfContext(t);return this.list[e]}},{key:"getIndexOfContext",value:function(t){return t=parseInt(t),this.list.findIndex((function(e){return e.id===t}))}},{key:"setActiveContext",value:function(t){this.activeContext=t}},{key:"getActiveContext",value:function(){return this.activeContext}},{key:"getAllContexts",value:function(){return this.list}}])&&f(e.prototype,n),t}();function p(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}var v=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.bodyElement=document.querySelector("body"),this.contextContainer=document.getElementById("context-container"),this.contextInput=document.getElementById("context-input"),this.contextButton=document.getElementById("context-add-button"),this.taskContainer=document.getElementById("task-container"),this.taskList=document.getElementById("tasks"),this.taskInput=document.getElementById("task-input"),this.taskButton=document.getElementById("task-add-button"),this.taskHeading=document.getElementById("heading-task-container"),this.activeContext=null,this.onClickAddContext=null,this.onClickDeleteItem=null,this.onClickChangeContext=null,this.onDclickEditContext=null,this.onEnterSaveInput=null,this.onClickOutsideSave=null,this.onClickAddTask=null,this.onMsDwnCopyTask=null,this.onMsUpAnalyzePosition=null}var e,n;return e=t,(n=[{key:"initListeners",value:function(){this.contextButton.addEventListener("click",this.onClickAddContext),this.taskButton.addEventListener("click",this.onClickAddTask)}},{key:"renderAllContexts",value:function(t,e){t.forEach(this.appendNewContext.bind(this)),this.activeContext=document.querySelector('[data-itemid="'.concat(e.id,'"]')),this.highlightActiveContext(this.activeContext)}},{key:"appendNewContext",value:function(t){var e=this.createDelBtn(),n=this.createInnerContent(t.text,e),o=this.createItemElement(t.id,n,"context");o.addEventListener("click",this.onClickChangeContext),this.contextContainer.appendChild(o)}},{key:"highlightActiveContext",value:function(t){this.activeContext.style.fontWeight="normal",this.activeContext=t,t.style.fontWeight="bold"}},{key:"renderTasks",value:function(t){this.taskList.innerHTML="",t.forEach(this.appendNewTask.bind(this))}},{key:"appendNewTask",value:function(t){var e=this.createDelBtn(),n=this.createInnerContent(t.text,e),o=this.createItemElement(t.id,n,"task");o.classList.add("task"),o.addEventListener("mousedown",this.onMsDwnCopyTask),this.taskList.appendChild(o)}},{key:"createItemElement",value:function(t,e,n){var o=document.createElement("p");return o.dataset.itemid=t,o.classList.add(n),o.addEventListener("dblclick",this.onDclickEditItem),o.appendChild(e),o}},{key:"createDelBtn",value:function(){var t=document.createElement("i");return t.classList.add("fa"),t.classList.add("fa-trash-o"),t.addEventListener("click",this.onClickDeleteItem),t}},{key:"createInnerContent",value:function(t,e){var n=document.createElement("div"),o=document.createElement("span");return o.innerHTML=t,n.appendChild(o),n.appendChild(e),n}},{key:"prepareItemEdit",value:function(t){this.saveItemElements(t);var e=this.defineMaxLength(),n=this.createInputBox(t,e);this.createEditableElement(n),this.bodyElement.addEventListener("click",this.onClickOutsideSave),n.addEventListener("click",(function(t){return t.stopPropagation()})),this.addContextListeners()}},{key:"saveItemElements",value:function(t){this.itemElements=t.firstChild}},{key:"defineMaxLength",value:function(){var t=this.itemElements.parentNode.className;return"task"===t?25:"context"===t?8:void 0}},{key:"createInputBox",value:function(t,e){var n=document.createElement("input"),o=t.firstChild.textContent;return n.type="text",n.id="edit-item-field",n.maxLength=e,n.value=o,n.addEventListener("keyup",this.onEnterSaveInput),n}},{key:"createEditableElement",value:function(t){var e=this.itemElements.parentNode;e.id="edit-item",e.firstChild.remove(),e.appendChild(t),t.focus()}},{key:"updateDomAfterEdit",value:function(t,e){this.itemElements.firstChild.innerHTML=e,t.firstChild.remove(),t.appendChild(this.itemElements),t.removeAttribute("id"),this.bodyElement.removeEventListener("click",this.onClickOutsideSave),this.addContextListeners()}},{key:"attachTaskToMouse",value:function(t){var e=this.createTaskCopy(t);this.bodyElement.addEventListener("mousemove",this.moveTaskWithMouse.bind(null,this,e)),this.bodyElement.addEventListener("mouseup",this.onMsUpAnalyzePosition);var n=document.querySelectorAll(".context"),o=this;n.forEach((function(t){t.addEventListener("mouseover",o.onMsOverHighlight),t.addEventListener("mouseout",o.onMsOutNormal),t.addEventListener("mouseup",o.onMsUpAnalyzePosition)})),this.changeUserSelect("none")}},{key:"onMsOverHighlight",value:function(){this.style.opacity="0.7"}},{key:"onMsOutNormal",value:function(){this.style.opacity="1"}},{key:"createTaskCopy",value:function(t){this.temporarySavedTaskElement=t;var e=this.temporarySavedTaskElement.cloneNode(!0);return e.id="task-copy",e.style.width="25vw",e.style.display="none",this.bodyElement.appendChild(e),e}},{key:"moveTaskWithMouse",value:function(t,e,n){var o=n.x,i=n.y;e.style.position="absolute",e.style.top="".concat(i,"px"),e.style.left="".concat(o+10,"px"),e.style.display="block"}},{key:"removeTaskCopy",value:function(){document.getElementById("task-copy").remove()}},{key:"undoTaskMoveActions",value:function(){this.removeTaskCopy(),this.bodyElement.removeEventListener("mouseup",this.onMsUpAnalyzePosition);var t=document.querySelectorAll(".context"),e=this;t.forEach((function(t){t.removeEventListener("mouseover",e.onMsOverHighlight),t.removeEventListener("mouseout",e.onMsOutNormal),t.removeEventListener("mouseup",e.onMsUpAnalyzePosition),t.style.opacity="1"})),this.changeUserSelect("auto")}},{key:"setContextHeading",value:function(t){this.taskHeading.innerText=t}},{key:"changeUserSelect",value:function(t){document.querySelectorAll("*").forEach((function(e){e.style.userSelect=t}))}},{key:"getItemId",value:function(t){return t.dataset.itemid}},{key:"getEditItem",value:function(){return document.getElementById("edit-item")}},{key:"getContextInputValue",value:function(){return this.contextInput.value}},{key:"resetContextInput",value:function(){this.contextInput.value=""}},{key:"removeElement",value:function(t){t.remove()}},{key:"removeTasks",value:function(){this.taskList.innerHTML=""}},{key:"getElementToDelete",value:function(t){return t.target.parentNode.parentNode}},{key:"getTaskInputValue",value:function(){return this.taskInput.value}},{key:"resetTaskInput",value:function(){this.taskInput.value=""}},{key:"getEditInput",value:function(){return document.getElementById("edit-item-field").value}},{key:"getClassName",value:function(t){return t.classList}},{key:"removeContextListeners",value:function(){var t=this;document.querySelectorAll(".context").forEach((function(e){e.removeEventListener("click",t.onClickChangeContext)}))}},{key:"addContextListeners",value:function(){var t=this;document.querySelectorAll(".context").forEach((function(e){e.addEventListener("click",t.onClickChangeContext)}))}}])&&p(e.prototype,n),t}();function k(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}new(function(){function t(e,n,o,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.Task=n,this.Context=o,this.contextList=new i(this.Context),this.todoDisplay=new e,this.init()}var e,n;return e=t,(n=[{key:"init",value:function(){this.setDefaultTasks(),this.todoDisplay.onClickAddContext=this.onClickAddContext.bind(this),this.todoDisplay.onClickAddTask=this.onClickAddTask.bind(this),this.todoDisplay.initListeners(),this.todoDisplay.onClickDeleteItem=this.onClickDeleteItem.bind(null,this),this.todoDisplay.onEnterSaveInput=this.saveInput.bind(null,this),this.todoDisplay.onClickOutsideSave=this.saveInput.bind(null,this);var t=this;this.todoDisplay.onClickChangeContext=function(){t.onClickChangeContext(this,t)},this.todoDisplay.onDclickEditItem=function(){t.onDclickEditItem(this,t)},this.todoDisplay.onMsDwnCopyTask=function(){t.onMsDwnCopyTask(this,t)},this.todoDisplay.onMsUpAnalyzePosition=function(e){t.onMsUpAnalyzePosition(e,this,t)},this.loadStartPage()}},{key:"setDefaultTasks",value:function(){this.activeContext=this.contextList.getActiveContext(),this.createNewTask("Double click me to edit my name"),this.createNewTask("Create a new list"),this.createNewTask("Click and hold me to move me to the new list")}},{key:"loadStartPage",value:function(){var t=this.contextList.getAllContexts(),e=this.activeContext.taskList;this.todoDisplay.renderTasks(e),this.todoDisplay.renderAllContexts(t,this.activeContext),this.todoDisplay.setContextHeading(this.activeContext.text)}},{key:"onClickAddContext",value:function(t){t.preventDefault();var e=this.todoDisplay.getContextInputValue()||"Give me a name";this.createNewContext(e),this.todoDisplay.resetContextInput()}},{key:"onClickAddTask",value:function(t){t.preventDefault();var e=this.todoDisplay.getTaskInputValue()||"Give me a name";this.createNewTask(e),this.todoDisplay.resetTaskInput()}},{key:"createNewTask",value:function(t){var e=new this.Task(t);this.contextList.getActiveContext().appendTask(e),this.todoDisplay.appendNewTask(e)}},{key:"createNewContext",value:function(t){var e=new this.Context(t);e.onClickChangeContext=this.onClickChangeContext,this.contextList.addNewContext(e),this.todoDisplay.appendNewContext(e)}},{key:"onClickDeleteItem",value:function(t,e){var n=t.todoDisplay.getElementToDelete(e),o=t.todoDisplay.getItemId(n),i=t.todoDisplay.getClassName(n);i.contains("context")?(t.contextList.deleteContext(o),t.todoDisplay.removeTasks()):i.contains("task")&&t.contextList.activeContext.deleteTask(o),t.todoDisplay.removeElement(n)}},{key:"onClickChangeContext",value:function(t,e){var n=e.todoDisplay.getItemId(t),o=e.contextList.getContext(n);this.contextList.setActiveContext(o);var i=o.taskList;this.todoDisplay.renderTasks(i),this.todoDisplay.highlightActiveContext(t),this.todoDisplay.setContextHeading(o.text)}},{key:"onDclickEditItem",value:function(t,e){e.todoDisplay.prepareItemEdit(t)}},{key:"saveInput",value:function(t,e){if("Enter"===e.key||"click"===e.type){var n=t.todoDisplay.getEditInput(),o=t.todoDisplay.getEditItem(),i=t.todoDisplay.getItemId(o),s=t.todoDisplay.getClassName(o);if(s.contains("context")){var a=t.contextList.getIndexOfContext(i);t.contextList.list[a].update(n)}else if(s.contains("task")){var r=t.contextList.activeContext.getIndexOfTask(i);t.contextList.activeContext.taskList[r].text=n}t.todoDisplay.updateDomAfterEdit(o,n)}}},{key:"onMsDwnCopyTask",value:function(t,e){e.todoDisplay.attachTaskToMouse(t)}},{key:"onMsUpAnalyzePosition",value:function(t,e,n){if(e.classList.contains("context")){var o=n.contextList.getActiveContext(),i=n.todoDisplay.temporarySavedTaskElement,s=n.todoDisplay.getItemId(i),a=n.contextList.activeContext.getTask(s),r=n.todoDisplay.getItemId(e);n.contextList.getContext(r).appendTask(a),o.deleteTask(a),n.todoDisplay.removeElement(i),t.stopPropagation()}n.todoDisplay.undoTaskMoveActions()}}])&&k(e.prototype,n),t}())(v,a,h,y)})();
//# sourceMappingURL=main.js.map